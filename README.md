# False Friend (Vite + React + TypeScript)

False Friend is a one-screen reaction game. Every round introduces a short new rule. Click only the true **friend** objects. Clicking a false friend ends the run instantly.

## Local development

```bash
npm install
npm run dev
```

Build check:

```bash
npm run build
```

## Gameplay summary

- Start screen with a single big **Start** button.
- 3-2-1 countdown, then round begins.
- Each round shows **20 objects**.
- Exactly **4 objects are friends** (correct targets).
- Every object stays on screen for exactly **2000ms**.
- Missing an object has no penalty.
- Clicking a false friend ends the run.
- Surviving a round gives an escalating completion bonus.

### Scoring

- Friend click score: `max(0, 2000 - reactionMs)`
- Round clear bonus: `floor(500 * roundNumber^1.2)`
- Optional passive bonus used in this build: `+10` for each false friend that expires without a click.

## Supabase setup (global leaderboard)

This game uses a dedicated table named `false_friend_scores`.

### 1) SQL

Run `supabase/false_friend_scores.sql` or paste the SQL below:

```sql
create table if not exists public.false_friend_scores (
  id bigint generated by default as identity primary key,
  run_id uuid not null unique,
  user_id text not null,
  name text not null,
  total_score integer not null,
  rounds_cleared integer not null,
  created_at timestamptz not null default now()
);

alter table public.false_friend_scores enable row level security;

drop policy if exists "read false friend scores" on public.false_friend_scores;
create policy "read false friend scores"
  on public.false_friend_scores
  for select
  to anon
  using (true);

drop policy if exists "insert false friend scores" on public.false_friend_scores;
create policy "insert false friend scores"
  on public.false_friend_scores
  for insert
  to anon
  with check (
    length(name) between 1 and 20
    and total_score >= 0
    and rounds_cleared >= 0
    and length(user_id) > 0
  );
```

### 2) Confirm permissions

- Public users can **read** and **insert** scores.
- Do **not** create public `update` or `delete` policies.

### 3) Front-end environment variables

Create a `.env` file:

```bash
VITE_SUPABASE_URL=your_project_url
VITE_SUPABASE_ANON_KEY=your_publishable_or_anon_key
```

Then restart `npm run dev`.

## Leaderboard row shape

Each submitted run stores:

- `run_id` (uuid)
- `user_id` (stable local id in browser storage)
- `name`
- `total_score`
- `rounds_cleared`
- `created_at`
